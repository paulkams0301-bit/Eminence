<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <link href="commande form.css" rel="stylesheet">
</head>

<body>
  <h1>Remplissez le formulaire pour envoyer votre commande </h1>
  <form>
    <label>
      Nom <input type="text" name="nom" placeholder="mettez votre nom">
    </label>
    <label>
      <br>
      <br>
      Adress <input type="text" name="addresse" placeholder="Masina, Petrocongo/Sans fil">
    </label>
    <br>
    <br>
    <label>
      choix du lieu de rendez-vous <select>
        <option>Coin Lokali</option>
        <option>Entr√©e Petrocongo </option>
        <option>Deux paillotes</option>
        <option>March√© d'Alivia</option>
        <option>Quartier 1</option>
        <option>b√¢timent</option>
        <option>paroisse divin Ma√Ætre </option>
        <option>Don Bosco </option>
        <option>Abbatoir</option>
      </select>
    </label>
    <br>
    <br>
    <label>
      Num√©ro <input type="number" name="num" placeholder="num√©ro de t√©l√©phone √† joindre">
    </label>
  </form>
  <div class="commande"><h4>produits command√©s,leurs prix et le total √† payer</h4></div>
  <button id="Envoyez" onclick="Envoyez()">Envoy√© sur WhatsApp </button>
  <script>
  const zoneCommande = document.querySelector(".commande");
  const data = localStorage.getItem("commande");

  let produits = [];
  let total = 0;

  if (data) {
    produits = JSON.parse(data);

    produits.forEach(p => {
      if (p.qte > 0) {
        const sousTotal = p.qte * p.prix;
        total += sousTotal;

        const ligne = document.createElement("p");
        ligne.innerText = `${p.nom} (${p.qte}) ‚Üí ${sousTotal} FC`;
        zoneCommande.appendChild(ligne);
      }
    });

    const totalDiv = document.createElement("h3");
    totalDiv.innerText = `Total √† payer : ${total} FC`;
    zoneCommande.appendChild(totalDiv);
  } else {
    zoneCommande.innerHTML += "<p>Aucun produit command√©</p>";
  }

  // üîπ FONCTION ENVOI WHATSAPP
  function Envoyez() {
    const nom = document.querySelector('input[name="nom"]').value;
    const adresse = document.querySelector('input[name="addresse"]').value;
    const numeroClient = document.querySelector('input[name="num"]').value;
    const lieu = document.querySelector("select").value;

    if (!nom || !adresse || !numeroClient) {
      alert("Veuillez remplir tous les champs");
      return;
    }

    let message = `üì¶ *Nouvelle commande* \n\n`;
    message += `üë§ Nom : ${nom}\n`;
    message += `üè† Adresse : ${adresse}\n`;
    message += `üìç Lieu : ${lieu}\n`;
    message += `üìû Num√©ro : ${numeroClient}\n\n`;
    message += `üõí *Produits command√©s* :\n`;

    produits.forEach(p => {
      if (p.qte > 0) {
        message += `- ${p.nom} (${p.qte}) : ${p.qte * p.prix} FC\n`;
      }
    });

    message += `\nüí∞ *Total √† payer : ${total} FC*`;

    // ‚ö†Ô∏è Num√©ro WhatsApp du vendeur (sans + ni espace)
    const numeroVendeur = "243814607870";

    const url = `https://wa.me/${numeroVendeur}?text=${encodeURIComponent(message)}`;

    // üî• Ouvre directement WhatsApp
    window.open(url, "_blank");
  }
</script>
</body>

</html>